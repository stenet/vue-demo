var O=Object.defineProperty;var p=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var h=(s,t,e)=>t in s?O(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,_=(s,t)=>{for(var e in t||(t={}))C.call(t,e)&&h(s,e,t[e]);if(p)for(var e of p(t))E.call(t,e)&&h(s,e,t[e]);return s};var l=(s,t,e)=>(h(s,typeof t!="symbol"?t+"":t,e),e);import{a5 as Z,a6 as tt,l as k,d as L,r as $,G as J,b as g,o as N,f as P,c as o,m as b,g as m,k as v}from"./vendor.e6b44e87.js";import{_ as I,u as A}from"./index.c01f7087.js";import{n as B}from"./notify.e82beeb8.js";import{u as D}from"./promise.177a1e8c.js";class V{constructor(){l(this,"_handlers",[])}addListener(t){this._handlers.push(t)}removeListener(t){const e=this._handlers.indexOf(t);e<0||this._handlers.splice(e,1)}publish(t){let e=!1;const r={detail:t,stopProgagation(){e=!0}};for(const n of this._handlers)if(n(r),e)return{isHandled:!0};return{isHandled:!1}}}class F{constructor(){l(this,"_regexDateISO",/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+)|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d)|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d)/)}parse(t){return t&&(typeof t!="string"&&(t=JSON.stringify(t)),JSON.parse(t,(e,r)=>{if(!(typeof r=="string"&&r.indexOf("{")<0))return r;const n=this._regexDateISO.exec(r);return n&&n.index==0?new Date(r):r}))}stringify(t){return JSON.stringify(t)}}class S{constructor(t){l(this,"_errorHandler");l(this,"defaultOptions");this._jsonService=t,this._errorHandler=new V,this.defaultOptions={errorHandler:this._errorHandler}}get(t){return this.fetch("GET",t)}post(t){return this.fetch("POST",t)}patch(t){return this.fetch("PATCH",t)}put(t){return this.fetch("PUT",t)}delete(t){return this.fetch("DELETE",t)}async fetch(t,e){const r=Object.assign({},this.defaultOptions,e),{abortController:n,finish:c}=this.createAbortHandler(e),a=await fetch(this.getUrl(e.url),_({method:t,signal:n.signal},r));switch(c(),a.status!=200&&this.handleError(e,a),this.getResultType(e)){case"json":return await this.getJson(a);case"binary":return await this.getBinary(a)}}createAbortHandler(t){let e=new AbortController;const r=()=>{e.abort()};t.abortSignal&&t.abortSignal.addEventListener("abort",r);const n=t.timeout||this.defaultOptions.timeout,c=n?setTimeout(()=>e.abort(),n):0;return{abortController:e,finish:()=>{t.abortSignal&&t.abortSignal.removeEventListener("abort",r),clearTimeout(c)}}}getUrl(t){return this.defaultOptions.url?`${this.defaultOptions.url}/${t}`:t}handleError(t,e){let r=!1;throw!r&&t.errorHandler&&(r=t.errorHandler(e)),r||(r=this._errorHandler.publish(e).isHandled),new Error(`${e.status}: ${e.statusText}`)}getResultType(t){return"resultType"in t&&t.resultType?t.resultType:"json"}async getJson(t){const e=await t.text();return e?this._jsonService.parse(e):null}async getBinary(t){return await t.blob()}}l(S,"inject",[F]);const U={class:"fetching col-container"},j={class:"col-md-3 col-xs-12"},G={class:"col-md-3 col-xs-12"},M={class:"col-md-3 col-xs-12"},R={class:"col-md-3 col-xs-12"},W={class:"col-xs-12"},q=["innerHTML"],z={class:"col-xs-12"},K=k(" Laden von Daten aus dem Web (mit FetchService) "),Q=L({setup(s){const t=$("https://api.predic8.de/shop/products/");function e(){t.value="https://api.predic8.de/shop/products/"}function r(){t.value="https://api.predic8.de/shop/products/62"}function n(){t.value="https://api.predic8.de/shop/vendors/32"}function c(){t.value="https://api.predic8.de/shop123456789"}const a=A(S);let d;const{promise:y,result:w,reload:x}=D();return J(async()=>{d==null||d.abort(),d=new AbortController,x(a.get({url:t.value,abortSignal:d.signal,timeout:500,errorHandler:f=>(B(f.statusText,"error",3e3),!0)}))}),(f,i)=>{const T=g("base-loading"),H=g("base-info");return N(),P("div",U,[o("div",j,[o("button",{onClick:i[0]||(i[0]=u=>e())},"Show products")]),o("div",G,[o("button",{onClick:i[1]||(i[1]=u=>r())},"Show product 62")]),o("div",M,[o("button",{onClick:i[2]||(i[2]=u=>n())},"Show vendor 32")]),o("div",R,[o("button",{onClick:i[3]||(i[3]=u=>c())},"Show error")]),o("div",W,[b(T,{promise:m(y)},{default:v(()=>[o("div",{class:"json",innerHTML:JSON.stringify(m(w))},null,8,q)]),_:1},8,["promise"])]),o("div",z,[b(H,null,{default:v(()=>[K]),_:1})])])}}});var nt=I(Q,[["__scopeId","data-v-a1957b02"]]);export{nt as default};
